{
  "metadata": {
    "config_name": "keep08",
    "model": "qwen2-7b-instruct",
    "hardware": {
      "gpu_count": 8,
      "gpu_model": "NVIDIA RTX 5880 Ada Generation",
      "gpu_memory_gb": 47.37200927734375,
      "cuda_version": "12.8"
    },
    "pruning_config": {
      "prune_layers": [
        4,
        7,
        10,
        13,
        16,
        19,
        22,
        25
      ],
      "keep_ratio": 0.8,
      "min_head_tokens": 4,
      "min_tail_ratio": 0.1,
      "cumulative_keep_ratio": 0.1677721600000001
    },
    "run_info": {
      "timestamp": "2025-11-21T23:07:07",
      "script": "inference_sdtp.py",
      "mode": "profile",
      "benchmark_mode": "end2end"
    }
  },
  "results": {
    "1024": {
      "baseline": {
        "prefill_latency_seconds": 0.12791750504402444,
        "decode_latency_seconds": 2.161683671933133,
        "total_latency_seconds": 2.2896011769771576,
        "memory_gb": 15.21665096282959,
        "kv_lens_after_prefill": [
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.12699423596495762,
        "decode_latency_seconds": 2.284697060997132,
        "total_latency_seconds": 2.41169129696209,
        "memory_gb": 14.527170658111572,
        "kv_lens_after_prefill": [
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171
        ],
        "tokens_kept": 171,
        "tokens_pruned": 853,
        "pruning_ratio": 0.8330078125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.0072701652327085,
        "decode": 0.946157680524038,
        "total": 0.9493757264295293
      },
      "kv_reduction": 0.8330078125,
      "memory_reduction": 0.04531091016033966
    },
    "2048": {
      "baseline": {
        "prefill_latency_seconds": 0.3122984250076115,
        "decode_latency_seconds": 2.570681023003999,
        "total_latency_seconds": 2.8829794480116107,
        "memory_gb": 16.15322780609131,
        "kv_lens_after_prefill": [
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.1784716810216196,
        "decode_latency_seconds": 2.927930079982616,
        "total_latency_seconds": 3.1064017610042356,
        "memory_gb": 14.768651485443115,
        "kv_lens_after_prefill": [
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342
        ],
        "tokens_kept": 342,
        "tokens_pruned": 1706,
        "pruning_ratio": 0.8330078125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.7498486214727842,
        "decode": 0.8779857963750494,
        "total": 0.928076813566962
      },
      "kv_reduction": 0.8330078125,
      "memory_reduction": 0.08571514853062841
    },
    "4096": {
      "baseline": {
        "prefill_latency_seconds": 0.7292715979856439,
        "decode_latency_seconds": 0.27093376201810315,
        "total_latency_seconds": 1.000205360003747,
        "memory_gb": 18.011229038238525,
        "kv_lens_after_prefill": [
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.37506826798198745,
        "decode_latency_seconds": 1.0162588179809973,
        "total_latency_seconds": 1.3913270859629847,
        "memory_gb": 15.242359638214111,
        "kv_lens_after_prefill": [
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685
        ],
        "tokens_kept": 685,
        "tokens_pruned": 3411,
        "pruning_ratio": 0.832763671875,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.944370292665406,
        "decode": 0.26659917456496723,
        "total": 0.7188858537253812
      },
      "kv_reduction": 0.832763671875,
      "memory_reduction": 0.15373017544477385
    },
    "8192": {
      "baseline": {
        "prefill_latency_seconds": 1.3554484910564497,
        "decode_latency_seconds": 3.2874203819665127,
        "total_latency_seconds": 4.642868873022962,
        "memory_gb": 21.737975120544434,
        "kv_lens_after_prefill": [
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.7128411250305362,
        "decode_latency_seconds": 4.674523961963132,
        "total_latency_seconds": 5.387365086993668,
        "memory_gb": 16.201777935028076,
        "kv_lens_after_prefill": [
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372
        ],
        "tokens_kept": 1372,
        "tokens_pruned": 6820,
        "pruning_ratio": 0.83251953125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.9014734748901951,
        "decode": 0.7032631362501165,
        "total": 0.861806986913122
      },
      "kv_reduction": 0.83251953125,
      "memory_reduction": 0.2546786052894195
    },
    "16384": {
      "baseline": {
        "prefill_latency_seconds": 3.5237411240232177,
        "decode_latency_seconds": 4.55692053999519,
        "total_latency_seconds": 8.080661664018407,
        "memory_gb": 29.191466331481934,
        "kv_lens_after_prefill": [
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 1.6137086240341887,
        "decode_latency_seconds": 8.14027538796654,
        "total_latency_seconds": 9.753984012000728,
        "memory_gb": 18.11825132369995,
        "kv_lens_after_prefill": [
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748
        ],
        "tokens_kept": 2748,
        "tokens_pruned": 13636,
        "pruning_ratio": 0.832275390625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.183629108465719,
        "decode": 0.5597993093368208,
        "total": 0.8284472943646859
      },
      "kv_reduction": 0.832275390625,
      "memory_reduction": 0.3793305509918809
    }
  },
  "summary": {
    "tested_lengths": [
      1024,
      2048,
      4096,
      8192,
      16384
    ],
    "avg_speedup": 0.8573185349999362,
    "avg_memory_reduction": 0.18375307808340846
  }
}