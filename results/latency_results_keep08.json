{
  "metadata": {
    "config_name": "keep08",
    "model": "qwen2-7b-instruct",
    "hardware": {
      "gpu_count": 8,
      "gpu_model": "NVIDIA RTX 5880 Ada Generation",
      "gpu_memory_gb": 47.37200927734375,
      "cuda_version": "12.8"
    },
    "pruning_config": {
      "prune_layers": [
        4,
        7,
        10,
        13,
        16,
        19,
        22,
        25
      ],
      "keep_ratio": 0.8,
      "min_head_tokens": 4,
      "min_tail_ratio": 0.1,
      "cumulative_keep_ratio": 0.1677721600000001
    },
    "run_info": {
      "timestamp": "2025-12-29T00:59:11",
      "script": "inference_erecap.py",
      "mode": "profile",
      "benchmark_mode": "end2end"
    }
  },
  "results": {
    "1024": {
      "baseline": {
        "prefill_latency_seconds": 0.14926061918959022,
        "decode_latency_seconds": 2.1194361429661512,
        "total_latency_seconds": 2.2686967621557415,
        "memory_gb": 15.21665096282959,
        "kv_lens_after_prefill": [
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.13201023917645216,
        "decode_latency_seconds": 2.516918827779591,
        "total_latency_seconds": 2.6489290669560432,
        "memory_gb": 14.416715145111084,
        "kv_lens_after_prefill": [
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171,
          171
        ],
        "tokens_kept": 171,
        "tokens_pruned": 853,
        "pruning_ratio": 0.8330078125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.1306745607064634,
        "decode": 0.8420756837978377,
        "total": 0.8564581024295841
      },
      "kv_reduction": 0.8330078125,
      "memory_reduction": 0.052569768451188485
    },
    "2048": {
      "baseline": {
        "prefill_latency_seconds": 0.31196426087990403,
        "decode_latency_seconds": 2.5729650971479714,
        "total_latency_seconds": 2.8849293580278754,
        "memory_gb": 16.15322780609131,
        "kv_lens_after_prefill": [
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.1803420470096171,
        "decode_latency_seconds": 2.557955482043326,
        "total_latency_seconds": 2.738297529052943,
        "memory_gb": 14.541882991790771,
        "kv_lens_after_prefill": [
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342,
          342
        ],
        "tokens_kept": 342,
        "tokens_pruned": 1706,
        "pruning_ratio": 0.8330078125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.7298476204124928,
        "decode": 1.0058678171727429,
        "total": 1.0535485378850142
      },
      "kv_reduction": 0.8330078125,
      "memory_reduction": 0.09975373551612429
    },
    "4096": {
      "baseline": {
        "prefill_latency_seconds": 0.7274657730013132,
        "decode_latency_seconds": 0.26155526423826814,
        "total_latency_seconds": 0.9890210372395813,
        "memory_gb": 18.011229038238525,
        "kv_lens_after_prefill": [
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.3826449988409877,
        "decode_latency_seconds": 2.62734895106405,
        "total_latency_seconds": 3.009993949905038,
        "memory_gb": 14.799771785736084,
        "kv_lens_after_prefill": [
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685,
          685
        ],
        "tokens_kept": 685,
        "tokens_pruned": 3411,
        "pruning_ratio": 0.832763671875,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.9011506101079856,
        "decode": 0.09955101857800079,
        "total": 0.32857907813096565
      },
      "kv_reduction": 0.832763671875,
      "memory_reduction": 0.17830306003462593
    },
    "8192": {
      "baseline": {
        "prefill_latency_seconds": 1.373260507825762,
        "decode_latency_seconds": 3.2874944051727653,
        "total_latency_seconds": 4.660754912998527,
        "memory_gb": 21.737975120544434,
        "kv_lens_after_prefill": [
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.7295691110193729,
        "decode_latency_seconds": 2.7828526911325753,
        "total_latency_seconds": 3.512421802151948,
        "memory_gb": 15.315549373626709,
        "kv_lens_after_prefill": [
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372,
          1372
        ],
        "tokens_kept": 1372,
        "tokens_pruned": 6820,
        "pruning_ratio": 0.83251953125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.8822898161176351,
        "decode": 1.1813397150514673,
        "total": 1.326934854504955
      },
      "kv_reduction": 0.83251953125,
      "memory_reduction": 0.2954472857431844
    },
    "16384": {
      "baseline": {
        "prefill_latency_seconds": 3.562849673908204,
        "decode_latency_seconds": 4.555386320222169,
        "total_latency_seconds": 8.118235994130373,
        "memory_gb": 29.191466331481934,
        "kv_lens_after_prefill": [
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 1.6326602110639215,
        "decode_latency_seconds": 0.7204830599948764,
        "total_latency_seconds": 2.353143271058798,
        "memory_gb": 16.34710454940796,
        "kv_lens_after_prefill": [
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748,
          2748
        ],
        "tokens_kept": 2748,
        "tokens_pruned": 13636,
        "pruning_ratio": 0.832275390625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.1822358686541863,
        "decode": 6.32268345109261,
        "total": 3.44995398026809
      },
      "kv_reduction": 0.832275390625,
      "memory_reduction": 0.4400039941885961
    },
    "32768": {
      "baseline": {
        "prefill_latency_seconds": 8.162117238622159,
        "decode_latency_seconds": 6.573787019588053,
        "total_latency_seconds": 14.735904258210212,
        "memory_gb": 44.097960472106934,
        "kv_lens_after_prefill": [
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 3.798607326578349,
        "decode_latency_seconds": 4.009258924983442,
        "total_latency_seconds": 7.807866251561791,
        "memory_gb": 18.41021490097046,
        "kv_lens_after_prefill": [
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496,
          5496
        ],
        "tokens_kept": 5496,
        "tokens_pruned": 27272,
        "pruning_ratio": 0.832275390625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.1487130774252217,
        "decode": 1.6396514025631814,
        "total": 1.887315149034811
      },
      "kv_reduction": 0.832275390625,
      "memory_reduction": 0.5825155017630491
    }
  },
  "summary": {
    "tested_lengths": [
      1024,
      2048,
      4096,
      8192,
      16384,
      32768
    ],
    "avg_speedup": 1.4837982837089034,
    "avg_memory_reduction": 0.27476555761612803
  }
}