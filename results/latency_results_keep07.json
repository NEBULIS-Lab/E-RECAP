{
  "metadata": {
    "config_name": "keep07",
    "model": "qwen2-7b-instruct",
    "hardware": {
      "gpu_count": 8,
      "gpu_model": "NVIDIA RTX 5880 Ada Generation",
      "gpu_memory_gb": 47.37200927734375,
      "cuda_version": "12.8"
    },
    "pruning_config": {
      "prune_layers": [
        4,
        7,
        10,
        13,
        16,
        19,
        22,
        25
      ],
      "keep_ratio": 0.7,
      "min_head_tokens": 4,
      "min_tail_ratio": 0.1,
      "cumulative_keep_ratio": 0.05764800999999997
    },
    "run_info": {
      "timestamp": "2025-11-21T23:08:24",
      "script": "inference_sdtp.py",
      "mode": "profile",
      "benchmark_mode": "end2end"
    }
  },
  "results": {
    "1024": {
      "baseline": {
        "prefill_latency_seconds": 0.1508273610379547,
        "decode_latency_seconds": 2.144553810940124,
        "total_latency_seconds": 2.295381171978079,
        "memory_gb": 15.21665096282959,
        "kv_lens_after_prefill": [
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.1153619330143556,
        "decode_latency_seconds": 2.2929757540114224,
        "total_latency_seconds": 2.408337687025778,
        "memory_gb": 14.49390459060669,
        "kv_lens_after_prefill": [
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57
        ],
        "tokens_kept": 57,
        "tokens_pruned": 967,
        "pruning_ratio": 0.9443359375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.3074274771313497,
        "decode": 0.935271036856084,
        "total": 0.953097725598773
      },
      "kv_reduction": 0.9443359375,
      "memory_reduction": 0.04749707238395531
    },
    "2048": {
      "baseline": {
        "prefill_latency_seconds": 0.3216392719768919,
        "decode_latency_seconds": 2.591379905003123,
        "total_latency_seconds": 2.913019176980015,
        "memory_gb": 16.15322780609131,
        "kv_lens_after_prefill": [
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.14405218901811168,
        "decode_latency_seconds": 2.940603254013695,
        "total_latency_seconds": 3.0846554430318065,
        "memory_gb": 14.704986095428467,
        "kv_lens_after_prefill": [
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117
        ],
        "tokens_kept": 117,
        "tokens_pruned": 1931,
        "pruning_ratio": 0.94287109375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.232796836821773,
        "decode": 0.8812409159467843,
        "total": 0.9443580428279225
      },
      "kv_reduction": 0.94287109375,
      "memory_reduction": 0.08965649021037866
    },
    "4096": {
      "baseline": {
        "prefill_latency_seconds": 0.7537521520280279,
        "decode_latency_seconds": 0.2626966789830476,
        "total_latency_seconds": 1.0164488310110755,
        "memory_gb": 18.011229038238525,
        "kv_lens_after_prefill": [
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.3068778419983573,
        "decode_latency_seconds": 1.026657205016818,
        "total_latency_seconds": 1.3335350470151752,
        "memory_gb": 15.114901065826416,
        "kv_lens_after_prefill": [
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235
        ],
        "tokens_kept": 235,
        "tokens_pruned": 3861,
        "pruning_ratio": 0.942626953125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.4561960782820633,
        "decode": 0.2558757467432806,
        "total": 0.762221310408131
      },
      "kv_reduction": 0.942626953125,
      "memory_reduction": 0.16080679259938868
    },
    "8192": {
      "baseline": {
        "prefill_latency_seconds": 1.3879635509802029,
        "decode_latency_seconds": 3.2740307659842074,
        "total_latency_seconds": 4.66199431696441,
        "memory_gb": 21.737975120544434,
        "kv_lens_after_prefill": [
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.54167943703942,
        "decode_latency_seconds": 4.706273110001348,
        "total_latency_seconds": 5.247952547040768,
        "memory_gb": 15.946577548980713,
        "kv_lens_after_prefill": [
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471
        ],
        "tokens_kept": 471,
        "tokens_pruned": 7721,
        "pruning_ratio": 0.9425048828125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.5623338381944074,
        "decode": 0.6956737718910813,
        "total": 0.8883453642493834
      },
      "kv_reduction": 0.9425048828125,
      "memory_reduction": 0.2664184469550848
    },
    "16384": {
      "baseline": {
        "prefill_latency_seconds": 3.596443217014894,
        "decode_latency_seconds": 4.570648607972544,
        "total_latency_seconds": 8.167091824987438,
        "memory_gb": 29.191466331481934,
        "kv_lens_after_prefill": [
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 1.3080250159837306,
        "decode_latency_seconds": 8.219701233960222,
        "total_latency_seconds": 9.527726249943953,
        "memory_gb": 17.607000827789307,
        "kv_lens_after_prefill": [
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943
        ],
        "tokens_kept": 943,
        "tokens_pruned": 15441,
        "pruning_ratio": 0.94244384765625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.749521739314829,
        "decode": 0.556060187332432,
        "total": 0.8571921160135642
      },
      "kv_reduction": 0.94244384765625,
      "memory_reduction": 0.3968442479780196
    }
  },
  "summary": {
    "tested_lengths": [
      1024,
      2048,
      4096,
      8192,
      16384
    ],
    "avg_speedup": 0.8810429118195549,
    "avg_memory_reduction": 0.19224461002536541
  }
}