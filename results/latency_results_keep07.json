{
  "metadata": {
    "config_name": "keep07",
    "model": "qwen2-7b-instruct",
    "hardware": {
      "gpu_count": 8,
      "gpu_model": "NVIDIA RTX 5880 Ada Generation",
      "gpu_memory_gb": 47.37200927734375,
      "cuda_version": "12.8"
    },
    "pruning_config": {
      "prune_layers": [
        4,
        7,
        10,
        13,
        16,
        19,
        22,
        25
      ],
      "keep_ratio": 0.7,
      "min_head_tokens": 4,
      "min_tail_ratio": 0.1,
      "cumulative_keep_ratio": 0.05764800999999997
    },
    "run_info": {
      "timestamp": "2025-12-29T01:00:29",
      "script": "inference_erecap.py",
      "mode": "profile",
      "benchmark_mode": "end2end"
    }
  },
  "results": {
    "1024": {
      "baseline": {
        "prefill_latency_seconds": 0.15674286102876067,
        "decode_latency_seconds": 2.138361577875912,
        "total_latency_seconds": 2.295104438904673,
        "memory_gb": 15.21665096282959,
        "kv_lens_after_prefill": [
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.12088146060705185,
        "decode_latency_seconds": 1.3893884057179093,
        "total_latency_seconds": 1.5102698663249612,
        "memory_gb": 14.416715145111084,
        "kv_lens_after_prefill": [
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57,
          57
        ],
        "tokens_kept": 57,
        "tokens_pruned": 967,
        "pruning_ratio": 0.9443359375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.296665843063256,
        "decode": 1.5390668074353202,
        "total": 1.5196651208366496
      },
      "kv_reduction": 0.9443359375,
      "memory_reduction": 0.052569768451188485
    },
    "2048": {
      "baseline": {
        "prefill_latency_seconds": 0.32519006403163075,
        "decode_latency_seconds": 2.5978864734061062,
        "total_latency_seconds": 2.923076537437737,
        "memory_gb": 16.15322780609131,
        "kv_lens_after_prefill": [
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.14914208883419633,
        "decode_latency_seconds": 0.38282974483445287,
        "total_latency_seconds": 0.5319718336686492,
        "memory_gb": 14.541882991790771,
        "kv_lens_after_prefill": [
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117,
          117
        ],
        "tokens_kept": 117,
        "tokens_pruned": 1931,
        "pruning_ratio": 0.94287109375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.1804043819793204,
        "decode": 6.786009991280878,
        "total": 5.4947956873567145
      },
      "kv_reduction": 0.94287109375,
      "memory_reduction": 0.09975373551612429
    },
    "4096": {
      "baseline": {
        "prefill_latency_seconds": 0.7600822681561112,
        "decode_latency_seconds": 0.2500856905244291,
        "total_latency_seconds": 1.0101679586805403,
        "memory_gb": 18.011229038238525,
        "kv_lens_after_prefill": [
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.31105648120865226,
        "decode_latency_seconds": 1.2208574851974845,
        "total_latency_seconds": 1.5319139664061368,
        "memory_gb": 14.799771785736084,
        "kv_lens_after_prefill": [
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235,
          235
        ],
        "tokens_kept": 235,
        "tokens_pruned": 3861,
        "pruning_ratio": 0.942626953125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.4435506542178715,
        "decode": 0.20484429473271035,
        "total": 0.6594155943694343
      },
      "kv_reduction": 0.942626953125,
      "memory_reduction": 0.17830306003462593
    },
    "8192": {
      "baseline": {
        "prefill_latency_seconds": 1.3963654860854149,
        "decode_latency_seconds": 3.292868366930634,
        "total_latency_seconds": 4.689233853016049,
        "memory_gb": 21.737975120544434,
        "kv_lens_after_prefill": [
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 0.5519002182409167,
        "decode_latency_seconds": 0.360460311640054,
        "total_latency_seconds": 0.9123605298809707,
        "memory_gb": 15.315549373626709,
        "kv_lens_after_prefill": [
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471,
          471
        ],
        "tokens_kept": 471,
        "tokens_pruned": 7721,
        "pruning_ratio": 0.9425048828125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.5301049717575403,
        "decode": 9.135175941973895,
        "total": 5.139671982114154
      },
      "kv_reduction": 0.9425048828125,
      "memory_reduction": 0.2954472857431844
    },
    "16384": {
      "baseline": {
        "prefill_latency_seconds": 3.624314779881388,
        "decode_latency_seconds": 4.560587121173739,
        "total_latency_seconds": 8.184901901055127,
        "memory_gb": 29.191466331481934,
        "kv_lens_after_prefill": [
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 1.3257571649737656,
        "decode_latency_seconds": 0.3641047729179263,
        "total_latency_seconds": 1.689861937891692,
        "memory_gb": 16.34710454940796,
        "kv_lens_after_prefill": [
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943,
          943
        ],
        "tokens_kept": 943,
        "tokens_pruned": 15441,
        "pruning_ratio": 0.94244384765625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.7337697095931643,
        "decode": 12.525480192487759,
        "total": 4.843532904982041
      },
      "kv_reduction": 0.94244384765625,
      "memory_reduction": 0.4400039941885961
    },
    "32768": {
      "baseline": {
        "prefill_latency_seconds": 8.235876475926489,
        "decode_latency_seconds": 6.611407029442489,
        "total_latency_seconds": 14.847283505368978,
        "memory_gb": 44.097960472106934,
        "kv_lens_after_prefill": [
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768
        ]
      },
      "erecap": {
        "prefill_latency_seconds": 2.9119291570968926,
        "decode_latency_seconds": 2.92501969775185,
        "total_latency_seconds": 5.8369488548487425,
        "memory_gb": 18.41021490097046,
        "kv_lens_after_prefill": [
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887,
          1887
        ],
        "tokens_kept": 1887,
        "tokens_pruned": 30881,
        "pruning_ratio": 0.942413330078125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 2.8283230915333855,
        "decode": 2.2602948740905817,
        "total": 2.54367202361819
      },
      "kv_reduction": 0.942413330078125,
      "memory_reduction": 0.5825155017630491
    }
  },
  "summary": {
    "tested_lengths": [
      1024,
      2048,
      4096,
      8192,
      16384,
      32768
    ],
    "avg_speedup": 3.3667922188795303,
    "avg_memory_reduction": 0.27476555761612803
  }
}