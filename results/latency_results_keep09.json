{
  "metadata": {
    "config_name": "keep09",
    "model": "qwen2-7b-instruct",
    "hardware": {
      "gpu_count": 8,
      "gpu_model": "NVIDIA RTX 5880 Ada Generation",
      "gpu_memory_gb": 47.37200927734375,
      "cuda_version": "12.8"
    },
    "pruning_config": {
      "prune_layers": [
        4,
        7,
        10,
        13,
        16,
        19,
        22,
        25
      ],
      "keep_ratio": 0.9,
      "min_head_tokens": 4,
      "min_tail_ratio": 0.1,
      "cumulative_keep_ratio": 0.4304672100000001
    },
    "run_info": {
      "timestamp": "2025-11-21T23:05:52",
      "script": "inference_sdtp.py",
      "mode": "profile",
      "benchmark_mode": "end2end"
    }
  },
  "results": {
    "1024": {
      "baseline": {
        "prefill_latency_seconds": 0.12138716399203986,
        "decode_latency_seconds": 2.1408531609922647,
        "total_latency_seconds": 2.2622403249843046,
        "memory_gb": 15.21665096282959,
        "kv_lens_after_prefill": [
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.13589964900165796,
        "decode_latency_seconds": 2.2971507069887593,
        "total_latency_seconds": 2.4330503559904173,
        "memory_gb": 14.602796077728271,
        "kv_lens_after_prefill": [
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438
        ],
        "tokens_kept": 438,
        "tokens_pruned": 586,
        "pruning_ratio": 0.572265625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 0.8932117550249077,
        "decode": 0.931960256015863,
        "total": 0.9297959326712819
      },
      "kv_reduction": 0.572265625,
      "memory_reduction": 0.040340997937115715
    },
    "2048": {
      "baseline": {
        "prefill_latency_seconds": 0.275157299998682,
        "decode_latency_seconds": 2.605843488010578,
        "total_latency_seconds": 2.88100078800926,
        "memory_gb": 16.15322780609131,
        "kv_lens_after_prefill": [
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.21477189502911642,
        "decode_latency_seconds": 2.9078728209715337,
        "total_latency_seconds": 3.12264471600065,
        "memory_gb": 14.920752048492432,
        "kv_lens_after_prefill": [
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879
        ],
        "tokens_kept": 879,
        "tokens_pruned": 1169,
        "pruning_ratio": 0.57080078125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.2811606470268337,
        "decode": 0.8961339262216955,
        "total": 0.9226156191406631
      },
      "kv_reduction": 0.57080078125,
      "memory_reduction": 0.07629903895332399
    },
    "4096": {
      "baseline": {
        "prefill_latency_seconds": 0.6676921750186011,
        "decode_latency_seconds": 0.24681757698999718,
        "total_latency_seconds": 0.9145097520085983,
        "memory_gb": 18.011229038238525,
        "kv_lens_after_prefill": [
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.4722359540173784,
        "decode_latency_seconds": 0.9661906329565682,
        "total_latency_seconds": 1.4384265869739465,
        "memory_gb": 15.54712724685669,
        "kv_lens_after_prefill": [
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761
        ],
        "tokens_kept": 1761,
        "tokens_pruned": 2335,
        "pruning_ratio": 0.570068359375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.4138952558322782,
        "decode": 0.2554543260626829,
        "total": 0.6357708904230386
      },
      "kv_reduction": 0.570068359375,
      "memory_reduction": 0.13680919753729487
    },
    "8192": {
      "baseline": {
        "prefill_latency_seconds": 1.2822351770009845,
        "decode_latency_seconds": 3.272555618023034,
        "total_latency_seconds": 4.554790795024019,
        "memory_gb": 21.737975120544434,
        "kv_lens_after_prefill": [
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.950614896020852,
        "decode_latency_seconds": 4.6000019229832105,
        "total_latency_seconds": 5.550616819004063,
        "memory_gb": 16.81102991104126,
        "kv_lens_after_prefill": [
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523
        ],
        "tokens_kept": 3523,
        "tokens_pruned": 4669,
        "pruning_ratio": 0.5699462890625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.3488481848625042,
        "decode": 0.7114248369489168,
        "total": 0.8205918267370647
      },
      "kv_reduction": 0.5699462890625,
      "memory_reduction": 0.22665152490890225
    },
    "16384": {
      "baseline": {
        "prefill_latency_seconds": 3.292131419002544,
        "decode_latency_seconds": 4.530157178989612,
        "total_latency_seconds": 7.822288597992156,
        "memory_gb": 29.191466331481934,
        "kv_lens_after_prefill": [
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 2.196703265013639,
        "decode_latency_seconds": 7.908788150001783,
        "total_latency_seconds": 10.105491415015422,
        "memory_gb": 19.33675527572632,
        "kv_lens_after_prefill": [
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050
        ],
        "tokens_kept": 7050,
        "tokens_pruned": 9334,
        "pruning_ratio": 0.5697021484375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.4986691518310753,
        "decode": 0.5728004206293716,
        "total": 0.7740631580141932
      },
      "kv_reduction": 0.5697021484375,
      "memory_reduction": 0.33758876460164894
    }
  },
  "summary": {
    "tested_lengths": [
      1024,
      2048,
      4096,
      8192,
      16384
    ],
    "avg_speedup": 0.8165674853972483,
    "avg_memory_reduction": 0.16353790478765715
  }
}