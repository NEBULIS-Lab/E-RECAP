{
  "metadata": {
    "config_name": "keep09",
    "model": "qwen2-7b-instruct",
    "hardware": {
      "gpu_count": 8,
      "gpu_model": "NVIDIA RTX 5880 Ada Generation",
      "gpu_memory_gb": 47.37200927734375,
      "cuda_version": "12.8"
    },
    "pruning_config": {
      "prune_layers": [
        4,
        7,
        10,
        13,
        16,
        19,
        22,
        25
      ],
      "keep_ratio": 0.9,
      "min_head_tokens": 4,
      "min_tail_ratio": 0.1,
      "cumulative_keep_ratio": 0.4304672100000001
    },
    "run_info": {
      "timestamp": "2025-11-22T00:44:37",
      "script": "inference_sdtp.py",
      "mode": "profile",
      "benchmark_mode": "end2end"
    }
  },
  "results": {
    "1024": {
      "baseline": {
        "prefill_latency_seconds": 0.11129476799396798,
        "decode_latency_seconds": 2.1413492140127346,
        "total_latency_seconds": 2.2526439820067026,
        "memory_gb": 15.21665096282959,
        "kv_lens_after_prefill": [
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024,
          1024
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.149939042981714,
        "decode_latency_seconds": 2.5666103300172836,
        "total_latency_seconds": 2.7165493729989976,
        "memory_gb": 14.490407943725586,
        "kv_lens_after_prefill": [
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438,
          438
        ],
        "tokens_kept": 438,
        "tokens_pruned": 586,
        "pruning_ratio": 0.572265625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 0.7422667624171848,
        "decode": 0.8343102141252251,
        "total": 0.8292299062909518
      },
      "kv_reduction": 0.572265625,
      "memory_reduction": 0.047726863215699106
    },
    "2048": {
      "baseline": {
        "prefill_latency_seconds": 0.25432554504368454,
        "decode_latency_seconds": 2.601803839963395,
        "total_latency_seconds": 2.8561293850070797,
        "memory_gb": 16.15322780609131,
        "kv_lens_after_prefill": [
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048,
          2048
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.23182517901295796,
        "decode_latency_seconds": 1.8281171720009297,
        "total_latency_seconds": 2.0599423510138877,
        "memory_gb": 14.69692850112915,
        "kv_lens_after_prefill": [
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879,
          879
        ],
        "tokens_kept": 879,
        "tokens_pruned": 1169,
        "pruning_ratio": 0.57080078125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.097057472904912,
        "decode": 1.4232150322813508,
        "total": 1.3865093766344068
      },
      "kv_reduction": 0.57080078125,
      "memory_reduction": 0.09015531276126709
    },
    "4096": {
      "baseline": {
        "prefill_latency_seconds": 0.6658059909823351,
        "decode_latency_seconds": 0.2480690969969146,
        "total_latency_seconds": 0.9138750879792497,
        "memory_gb": 18.011229038238525,
        "kv_lens_after_prefill": [
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096,
          4096
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.47698169702198356,
        "decode_latency_seconds": 2.8408891769940965,
        "total_latency_seconds": 3.31787087401608,
        "memory_gb": 15.1237473487854,
        "kv_lens_after_prefill": [
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761,
          1761
        ],
        "tokens_kept": 1761,
        "tokens_pruned": 2335,
        "pruning_ratio": 0.570068359375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.395873248678657,
        "decode": 0.08732093423629883,
        "total": 0.27544022135890406
      },
      "kv_reduction": 0.570068359375,
      "memory_reduction": 0.1603156388341346
    },
    "8192": {
      "baseline": {
        "prefill_latency_seconds": 1.2824639669852331,
        "decode_latency_seconds": 3.272704414965119,
        "total_latency_seconds": 4.555168381950352,
        "memory_gb": 21.737975120544434,
        "kv_lens_after_prefill": [
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192,
          8192
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 0.9464664820116013,
        "decode_latency_seconds": 3.3383781510055996,
        "total_latency_seconds": 4.284844633017201,
        "memory_gb": 15.943887710571289,
        "kv_lens_after_prefill": [
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523,
          3523
        ],
        "tokens_kept": 3523,
        "tokens_pruned": 4669,
        "pruning_ratio": 0.5699462890625,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.3550019904133417,
        "decode": 0.9803276522101914,
        "total": 1.063088343238901
      },
      "kv_reduction": 0.5699462890625,
      "memory_reduction": 0.2665421860979676
    },
    "16384": {
      "baseline": {
        "prefill_latency_seconds": 3.2847713290248066,
        "decode_latency_seconds": 4.543263295956422,
        "total_latency_seconds": 7.828034624981228,
        "memory_gb": 29.191466331481934,
        "kv_lens_after_prefill": [
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384,
          16384
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 2.20935911196284,
        "decode_latency_seconds": 4.456451136968099,
        "total_latency_seconds": 6.6658102489309385,
        "memory_gb": 17.597832679748535,
        "kv_lens_after_prefill": [
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050,
          7050
        ],
        "tokens_kept": 7050,
        "tokens_pruned": 9334,
        "pruning_ratio": 0.5697021484375,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.4867530186645612,
        "decode": 1.0194801101414936,
        "total": 1.1743560546501735
      },
      "kv_reduction": 0.5697021484375,
      "memory_reduction": 0.39715831743710955
    },
    "32768": {
      "baseline": {
        "prefill_latency_seconds": 7.737775372050237,
        "decode_latency_seconds": 6.511712039995473,
        "total_latency_seconds": 14.24948741204571,
        "memory_gb": 44.097960472106934,
        "kv_lens_after_prefill": [
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768,
          32768
        ]
      },
      "sdtp": {
        "prefill_latency_seconds": 5.039820640988182,
        "decode_latency_seconds": 7.212822903995402,
        "total_latency_seconds": 12.252643544983584,
        "memory_gb": 20.909603595733643,
        "kv_lens_after_prefill": [
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103,
          14103
        ],
        "tokens_kept": 14103,
        "tokens_pruned": 18665,
        "pruning_ratio": 0.569610595703125,
        "pruning_steps": 8
      },
      "speedup": {
        "prefill": 1.5353275291425954,
        "decode": 0.902796606358994,
        "total": 1.1629724932200172
      },
      "kv_reduction": 0.569610595703125,
      "memory_reduction": 0.5258373999187674
    }
  },
  "summary": {
    "tested_lengths": [
      1024,
      2048,
      4096,
      8192,
      16384,
      32768
    ],
    "avg_speedup": 0.9819327325655592,
    "avg_memory_reduction": 0.2479559530441576
  }
}